# -*- coding: utf-8 -*-
"""Hackbio_stage_one.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1VTRY3y_nSuUeobgTzfJtAqmfb8sNHdEX
"""

def dna_to_protein(dna_sequence):
    """
    Translate a DNA sequence to a protein sequence using the standard genetic code.

    Args:
        dna_sequence (str): A string of DNA nucleotides (A, T, G, C)

    Returns:
        str: The translated protein sequence
    """
    # Genetic code dictionary (i got the genetic code from here, https://www.hgmd.cf.ac.uk/docs/cd_amino.html)
    genetic_code = {
        'TTT': 'F', 'TTC': 'F', 'TTA': 'L', 'TTG': 'L',
        'TCT': 'S', 'TCC': 'S', 'TCA': 'S', 'TCG': 'S',
        'TAT': 'Y', 'TAC': 'Y', 'TAA': '*', 'TAG': '*',
        'TGT': 'C', 'TGC': 'C', 'TGA': '*', 'TGG': 'W',
        'CTT': 'L', 'CTC': 'L', 'CTA': 'L', 'CTG': 'L',
        'CCT': 'P', 'CCC': 'P', 'CCA': 'P', 'CCG': 'P',
        'CAT': 'H', 'CAC': 'H', 'CAA': 'Q', 'CAG': 'Q',
        'CGT': 'R', 'CGC': 'R', 'CGA': 'R', 'CGG': 'R',
        'ATT': 'I', 'ATC': 'I', 'ATA': 'I', 'ATG': 'M',
        'ACT': 'T', 'ACC': 'T', 'ACA': 'T', 'ACG': 'T',
        'AAT': 'N', 'AAC': 'N', 'AAA': 'K', 'AAG': 'K',
        'AGT': 'S', 'AGC': 'S', 'AGA': 'R', 'AGG': 'R',
        'GTT': 'V', 'GTC': 'V', 'GTA': 'V', 'GTG': 'V',
        'GCT': 'A', 'GCC': 'A', 'GCA': 'A', 'GCG': 'A',
        'GAT': 'D', 'GAC': 'D', 'GAA': 'E', 'GAG': 'E',
        'GGT': 'G', 'GGC': 'G', 'GGA': 'G', 'GGG': 'G'
    }

    # Convert to uppercase and remove any whitespace
    dna_sequence = dna_sequence.upper().replace(' ', '').replace('\n', '')

    # Ensure the sequence length is divisible by 3
    if len(dna_sequence) % 3 != 0:
        # Add 'N' nucleotides to make it divisible by 3
        padding_length = 3 - (len(dna_sequence) % 3)
        dna_sequence += 'N' * padding_length

    protein_sequence = ""

    # Translate each codon
    for i in range(0, len(dna_sequence), 3):
        codon = dna_sequence[i:i+3]

        # If codon is incomplete or not recognized, treat as stop codon
        if len(codon) < 3 or codon not in genetic_code:
            protein_sequence += '*'
        else:
            protein_sequence += genetic_code[codon]

    return protein_sequence


def hamming_distance(str1, str2):
    """
    Calculate the Hamming distance between two strings.
    The Hamming distance is the number of positions at which the corresponding symbols are different.

    Args:
        str1 (str): First string
        str2 (str): Second string

    Returns:
        int: The Hamming distance between the two strings
    """
    # Pad the shorter string with extra characters to make them equal length
    max_len = max(len(str1), len(str2))
    str1 = str1.ljust(max_len)
    str2 = str2.ljust(max_len)

    # Calculate the Hamming distance
    distance = 0
    for i in range(max_len):
        if str1[i] != str2[i]:
            distance += 1

    return distance


# Example:
if __name__ == "__main__":
    # Process team members  read DNA sequences from their respective FASTA files
    team_members = [
        {"name": "Teodora", "username": "Teodora", "fasta_file": "Teodora_sequence.fasta"},
        {"name": "Augusta Ilechukwu", "username": "Augusta Ilechukwu ", "fasta_file": "Augusta_sequence.fasta"},
        {"name": "Sultan Alkhazraji", "username": "Sultan Alkhazraji ", "fasta_file": "Sultan_sequence.fasta"},
        {"name": "Jovana Aleksic", "username": "Jovana Aleksic", "fasta_file": "Jovana_sequence.fasta"},
        {"name": "Auwal Ibrahim", "username": "Auwal Ibrahim", "fasta_file": "Auwal_sequence.fasta"}
    ]

    for member in team_members:
        print(f"\n--- {member['name']} ---")
        slack_username = member['username'].strip()
        # Generate bluesky handle if not in CSV (synthesize one)
        bluesky_handle = f"{slack_username.lower().replace(' ', '')}.bsky.social"
        hamming_dist = hamming_distance(slack_username, bluesky_handle)
        print(f"Slack username: {slack_username}")
        print(f"Bluesky handle: {bluesky_handle}")
        print(f"Hamming distance between '{slack_username}' and '{bluesky_handle}': {hamming_dist}")

        # Read DNA sequence from the FASTA file for this member
        try:
            with open(member['fasta_file'], 'r') as file:
                lines = file.readlines()
                # Skip the first line (because its a header) and connect the rest
                dna_sequence = ''.join(lines[1:]).replace('\n', '').replace(' ', '')

            protein = dna_to_protein(dna_sequence)
            print(f"DNA sequence length: {len(dna_sequence)}")
            print(f"Protein sequence: {protein}")

        except FileNotFoundError:
            print(f"DNA file for {member['name']} not found")